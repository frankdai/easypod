var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,l=(t,a,r)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[a]=r;import{r as u,R as o,u as i,B as c,j as d,S as p,k as f,a as h}from"./vendor.662227cf.js";function b(){let[e,i]=u.exports.useState(null),[c,d]=u.exports.useState(null);u.exports.useEffect((()=>{let e=firebase.database().ref(`/users/${sessionStorage.getItem("uid")}`);e.get().catch((e=>{console.error(e)})),e.on("value",(e=>{i(e.val())})),firebase.database().ref("/channels").on("value",(e=>{d(e.val())}))}),[]);let p=u.exports.useMemo((()=>{let t=[];return e&&e.channels&&c&&(t=e.channels),t.map((e=>c[e]))}),[e,c]);return o.createElement("div",null,e?e.displayName:"loading",o.createElement("button",{onClick:function(){let u=window.prompt("Add URL"),o="";if(Object.keys(c).forEach((e=>{c[e].url===u&&(o=e)})),!o){let e={};o=firebase.database().ref().child("channels").push().key,e["/channels/"+o]={url:u},firebase.database().ref().update(e)}var i,d;e.channels&&-1!==e.channels.indexOf(o)||firebase.database().ref(`/users/${sessionStorage.getItem("uid")}`).set((i=((e,t)=>{for(var a in t||(t={}))n.call(t,a)&&l(e,a,t[a]);if(r)for(var a of r(t))s.call(t,a)&&l(e,a,t[a]);return e})({},e),d={channels:[...e.channels||[],o]},t(i,a(d))))}},"Add a new podcast"),p.map((e=>o.createElement("a",{href:e.url,key:e.url},e.name))))}const m=firebase.database(),g=o.createContext(m);var E=()=>{let[e,t]=u.exports.useState("Frank");return o.createElement(c,null,o.createElement(d,{guards:[(e,t,a)=>{e.meta.auth?(firebase.auth().currentUser&&a(),a.redirect("/login")):a()}]},o.createElement(p,null,o.createElement(g.Provider,{value:m},o.createElement(f,{path:"/login",exact:!0,component:()=>function({setCurrentUser:e}){const t=i(),a=u.exports.useCallback(e,[e]);return u.exports.useEffect((()=>{firebase.auth().currentUser?t.push("dashboard",""):(firebase.auth().onAuthStateChanged((e=>{if(e){let{pictureUrl:r,displayName:n,email:s}=e;a({pictureUrl:r,displayName:n,email:s}),sessionStorage.setItem("uid",e.uid),t.push("dashboard","")}})),new firebaseui.auth.AuthUI(firebase.auth()).start("#firebaseui-auth-container",{signInFlow:"popup",callbacks:{signInSuccessWithAuthResult:function(e,t){return sessionStorage.setItem("uid",e.user.uid),!1}},signInOptions:[firebase.auth.GoogleAuthProvider.PROVIDER_ID]}))}),[]),o.createElement("div",{id:"firebaseui-auth-container"})}({setCurrentUser:t}),meta:{auth:!1}}),o.createElement(f,{path:"/dashboard",exact:!0,component:b,meta:{auth:!0}})))))};h.render(o.createElement(o.StrictMode,null,o.createElement(E,null)),document.getElementById("root"));
